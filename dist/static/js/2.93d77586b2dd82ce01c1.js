webpackJsonp([2],{"2Bbf":function(e,t,i){"use strict";var a=i("woOf"),r=i.n(a),s=i("Xxa5"),n=i.n(s),o=i("exGp"),c=i.n(o),l=i("BO1k"),d=i.n(l),u=i("Dd8w"),f=i.n(u),m=i("sCp5"),p=i("FN8c"),v=i("oAV5"),h=i("NYxO"),w=["项目土地方","项目权属单位管理人员","项目居间方","项目介绍方"],b={name:"userVerify",props:{certificateModalVisible:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},uploadPicURL:{type:String,default:"/api/system/pics/"},passedInCertificateForm:{type:Object,default:function(){return{certificatePicList:[]}}}},watch:{certificateModalVisible:function(){this.initForm()}},data:function(){return{certificateForm:{certificatePicList:[]},certificateRules:{name:[{required:!0,message:"姓名不能为空!",trigger:"blur"}],position:[{required:!0,message:"职位不能为空!",trigger:"blur"}],company:[{required:!0,message:"所属公司不能为空!",trigger:"blur"}]},identities:w,previewImage:"",previewVisible:!1,loading:!1}},methods:f()({},Object(h.b)(["getUserInfo"]),{closeModal:function(){this.$emit("closeUserVerifyModal")},initForm:function(){this.certificateForm=v.a.Copy(this.passedInCertificateForm);var e=[];if(this.certificateForm&&this.certificateForm.pictures){var t=!0,i=!1,a=void 0;try{for(var r,s=d()(this.certificateForm.pictures);!(t=(r=s.next()).done);t=!0){var n=r.value;e.push({uuid:n.uuid,uid:n.uuid,name:n.uuid,status:"done",thumbUrl:"/api/system/pics/"+n.uuid+"/",response:{code:p.b.SUCCESS,data:{uuid:n.uuid}}})}}catch(e){i=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw a}}}this.$set(this.certificateForm,"certificatePicList",e)},handleChange:function(e,t,i){var a=this;return c()(n.a.mark(function r(){return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==e.fileList.length){r.next=3;break}return a[t][i]=[],r.abrupt("return");case 3:e.file.response?e.file.response.code!==p.b.SUCCESS?(e.fileList[e.fileList.length-1].status="error",a.loading=!1):(a.loading=!1,e.fileList[e.fileList.length-1].status="done",e.fileList[e.fileList.length-1].uuid=e.file.response.data.uuid):(e.fileList[e.fileList.length-1].status="uploading",a.loading=!0),a[t][i]=e.fileList;case 5:case"end":return r.stop()}},r,a)}))()},handlePreview:function(e){var t=this;return c()(n.a.mark(function i(){return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.uuid||e.preview||"temp"!==e.response.data.status){i.next=4;break}return i.next=3,v.a.getBase64(e.originFileObj);case 3:e.preview=i.sent;case 4:t.previewImage="/api/system/pics/"+e.uuid+"/"||e.preview,t.previewVisible=!0;case 6:case"end":return i.stop()}},i,t)}))()},submitCertificateForm:function(){var e=this,t={};r()(t,this.certificateForm),t.certificatePicList=[];for(var i=0;i<this.certificateForm.certificatePicList.length;i++)this.certificateForm.certificatePicList[i].response.code===p.b.SUCCESS&&t.certificatePicList.push(this.certificateForm.certificatePicList[i].response.data.uuid);this.$refs.certificateForm.validate(function(i){if(i){if(e.certificateForm.ID)return void m.a.editCertificateForm(t).then(function(){e.$success("身份认证修改成功!"),e.getUserInfo(),e.closeModal(),e.$emit("changed")});m.a.submitCertificateForm(t).then(function(){e.$success("身份认证成功!"),e.getUserInfo(),e.closeModal(),e.$emit("changed")})}})}})},g={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-modal",{attrs:{width:"80%",footer:null,title:"身份认证",closable:!1},model:{value:e.certificateModalVisible,callback:function(t){e.certificateModalVisible=t},expression:"certificateModalVisible"}},[i("a-row",{attrs:{gutter:20}},[i("a-col",{staticStyle:{"border-right":"2px solid #e0e0e0"},attrs:{span:12}},[i("a-form-model",{ref:"certificateForm",attrs:{model:e.certificateForm,"label-col":{span:6},"wrapper-col":{span:17},rules:e.certificateRules}},[i("a-form-model-item",{attrs:{label:"姓名",prop:"name"}},[i("a-input",{attrs:{disabled:!e.editable},model:{value:e.certificateForm.name,callback:function(t){e.$set(e.certificateForm,"name",t)},expression:"certificateForm.name"}})],1),e._v(" "),i("a-form-model-item",{attrs:{label:"所属公司",prop:"company"}},[i("a-input",{attrs:{disabled:!e.editable},model:{value:e.certificateForm.company,callback:function(t){e.$set(e.certificateForm,"company",t)},expression:"certificateForm.company"}})],1),e._v(" "),i("a-form-model-item",{attrs:{label:"职位",prop:"position"}},[i("a-input",{attrs:{disabled:!e.editable},model:{value:e.certificateForm.position,callback:function(t){e.$set(e.certificateForm,"position",t)},expression:"certificateForm.position"}})],1)],1)],1),e._v(" "),i("a-col",{attrs:{span:12}},[i("p",[e._v("证明材料")]),e._v(" "),i("a-upload",{staticClass:"file-uploader",attrs:{action:e.uploadPicURL,name:"file","file-list":e.certificateForm.certificatePicList,withCredentials:!0,disabled:!e.editable,"list-type":"picture-card"},on:{preview:e.handlePreview,change:function(t){return e.handleChange(t,"certificateForm","certificatePicList")}}},[e.certificateForm.certificatePicList.length<1?i("div",[i("a-icon",{attrs:{type:e.loading?"loading":"plus"}})],1):e._e()]),e._v(" "),i("p",{staticStyle:{color:"#9c9c9c"}},[e._v("\n            选填，可为名片、OA通讯录/流程截图等\n          ")]),e._v(" "),i("p",{staticStyle:{color:"#9c9c9c"}},[e._v("\n            录入后可显示实名认证标志\n          ")])],1)],1),e._v(" "),i("a-row",{staticClass:"mt-10",staticStyle:{"text-align":"center"}},[i("a-button",{staticStyle:{width:"20%"},on:{click:e.closeModal}},[e._v("取 消")]),e._v(" "),i("a-button",{staticStyle:{"margin-left":"40px",width:"20%"},attrs:{disabled:!e.editable,type:"primary"},on:{click:e.submitCertificateForm}},[e._v("提 交")])],1)],1),e._v(" "),i("a-modal",{attrs:{width:"80%",visible:e.previewVisible,footer:null},on:{cancel:function(t){e.previewVisible=!1}}},[i("img",{staticStyle:{width:"100%"},attrs:{src:e.previewImage}})])],1)},staticRenderFns:[]};var y=i("VU/8")(b,g,!1,function(e){i("JoIO")},"data-v-bf6339a0",null);t.a=y.exports},JoIO:function(e,t){},KEvy:function(e,t){},"Q/wC":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Xxa5"),r=i.n(a),s=i("exGp"),n=i.n(s),o=i("Dd8w"),c=i.n(o),l=i("NYxO"),d=i("2Bbf"),u=i("sCp5"),f={name:"userInfo",components:{userVerify:d.a},data:function(){var e=this;return{passwordRules:{oldPassword:[{required:!0,message:"请输入密码!",trigger:"blur"},{min:5,max:256,message:"密码长度为5-256字符!",trigger:"blur"}],newPassword:[{required:!0,message:"请输入密码!",trigger:"blur"},{min:5,max:256,message:"密码长度为5-256字符!",trigger:"blur"}],newPassword2:[{required:!0,message:"请输入密码!",trigger:"blur"},{validator:function(t,i,a){i!==e.passwordForm.newPassword&&a(new Error("两次输入密码不一致!")),a()},trigger:"blur"}]},certificateModalVisible:!1,changePasswordVisible:!1,passwordForm:{oldPassword:"",newPassword:"",newPassword2:""},certificateForm:{certificatePicList:[]}}},computed:c()({},Object(l.c)(["userInfo"])),mounted:function(){this.init()},methods:c()({},Object(l.b)(["getUserInfo"]),{init:function(){this.certificateForm=this.userInfo.certificate},certificateChange:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserInfo();case 2:e.init();case 3:case"end":return t.stop()}},t,e)}))()},changePassword:function(){var e=this;this.$refs.passwordForm.validate(function(t){t&&u.a.changePassword(e.passwordForm).then(function(t){e.$success("密码修改成功!"),e.changePasswordVisible=!1})})}})},m={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-row",[i("a-col",{staticClass:"card",attrs:{span:8}},[i("a-col",{attrs:{span:8}},[i("img",{staticStyle:{width:"100%"},attrs:{src:"/static/imgs/default.jpeg"}})]),e._v(" "),i("a-col",{staticStyle:{"padding-left":"10px"},attrs:{span:16}},[i("div",{staticClass:"username"},[e._v("\n          "+e._s(e.userInfo.user_name)+"\n        ")]),e._v(" "),i("div",[e.userInfo.certificationVerified||0!==e.userInfo.certificate.ID?e._e():i("a",{staticClass:"tag-desc",on:{click:function(t){e.certificateModalVisible=!0}}},[e._v("点击完成实名认证"),i("a-icon",{staticClass:"ml-5",staticStyle:{color:"gray"},attrs:{theme:"filled",type:"down-circle"}})],1),e._v(" "),e.userInfo.certificationVerified||0===e.userInfo.certificate.ID?e._e():i("a",{staticClass:"tag-desc",on:{click:function(t){e.certificateModalVisible=!0}}},[e._v("等待管理员认证"),i("a-icon",{staticClass:"ml-5",staticStyle:{color:"gray"},attrs:{theme:"filled",type:"down-circle"}})],1),e._v(" "),e.userInfo.certificationVerified?i("a",{staticClass:"tag-desc",on:{click:function(t){e.certificateModalVisible=!0}}},[e._v("已完成实名认证"),i("a-icon",{staticClass:"ml-5",staticStyle:{color:"forestgreen"},attrs:{theme:"filled",type:"down-circle"}})],1):e._e(),e._v(" "),i("userVerify",{attrs:{editable:0===e.userInfo.certificate.ID&&!e.userInfo.certificationVerified,passedInCertificateForm:e.certificateForm,certificateModalVisible:e.certificateModalVisible},on:{changed:e.certificateChange,closeUserVerifyModal:function(t){e.certificateModalVisible=!1}}})],1),e._v(" "),i("div",[i("a",{staticClass:"tag-desc",on:{click:function(t){e.changePasswordVisible=!0}}},[e._v("修改密码")])])])],1),e._v(" "),i("a-modal",{attrs:{width:"30%"},on:{ok:e.changePassword},model:{value:e.changePasswordVisible,callback:function(t){e.changePasswordVisible=t},expression:"changePasswordVisible"}},[i("a-form-model",{ref:"passwordForm",attrs:{model:e.passwordForm,rules:e.passwordRules,"label-col":{span:5},"wrapper-col":{span:18}}},[i("a-form-model-item",{ref:"oldPassword",attrs:{label:"旧密码",prop:"oldPassword"}},[i("a-input",{attrs:{type:"password"},on:{blur:function(){e.$refs.oldPassword.onFieldBlur()}},model:{value:e.passwordForm.oldPassword,callback:function(t){e.$set(e.passwordForm,"oldPassword",t)},expression:"passwordForm.oldPassword"}})],1),e._v(" "),i("a-form-model-item",{ref:"newPassword",attrs:{label:"新密码",prop:"newPassword"}},[i("a-input",{attrs:{type:"password"},on:{blur:function(){e.$refs.newPassword.onFieldBlur()}},model:{value:e.passwordForm.newPassword,callback:function(t){e.$set(e.passwordForm,"newPassword",t)},expression:"passwordForm.newPassword"}})],1),e._v(" "),i("a-form-model-item",{ref:"newPassword2",attrs:{label:"确认新密码",prop:"newPassword2"}},[i("a-input",{attrs:{type:"password"},on:{blur:function(){e.$refs.newPassword2.onFieldBlur()}},model:{value:e.passwordForm.newPassword2,callback:function(t){e.$set(e.passwordForm,"newPassword2",t)},expression:"passwordForm.newPassword2"}})],1)],1)],1)],1)},staticRenderFns:[]};var p=i("VU/8")(f,m,!1,function(e){i("KEvy")},"data-v-f45022c6",null);t.default=p.exports},jqfP:function(e,t){},kPNX:function(e,t){},l7c4:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("Dd8w"),r=i.n(a),s=i("oAV5"),n=i("NYxO"),o={userCenterLandResource:["userCenterLandResource","editLandResource","publishLandResource"],userCenterIndustryResource:["userCenterIndustryResource","editIndustryResource","publishIndustryResource"],userInfo:["userInfo"],userManage:["userManage"]},c={name:"userCenter",data:function(){return{MenuList:o,utils:s.a,selectedKey:[]}},mounted:function(){this.init()},computed:r()({},Object(n.c)(["userInfo"])),watch:{$route:function(e,t){this.selectMenu()}},methods:{init:function(){this.selectMenu()},selectMenu:function(){for(var e in this.MenuList)this.MenuList[e].includes(this.$route.name)&&(this.selectedKey=[e])}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-row",{staticStyle:{"min-height":"calc(100% - 180px)"}},[i("a-col",{attrs:{span:3}},[i("a-menu",{staticStyle:{width:"100%"},attrs:{"selected-keys":e.selectedKey,mode:"inline"}},[i("a-menu-item",{key:"userInfo"},[i("router-link",{attrs:{to:{name:"userInfo"}}},[i("a-icon",{attrs:{type:"solution"}}),e._v(" "),i("span",[e._v("个人信息")])],1)],1),e._v(" "),i("a-menu-item",{key:"userCenterLandResource"},[i("router-link",{attrs:{to:{name:"userCenterLandResource"}}},[i("a-icon",{attrs:{type:"pie-chart"}}),e._v(" "),i("span",[e._v("土地资源")])],1)],1),e._v(" "),i("a-menu-item",{key:"userCenterIndustryResource"},[i("router-link",{attrs:{to:{name:"userCenterIndustryResource"}}},[i("a-icon",{attrs:{type:"pie-chart"}}),e._v(" "),i("span",[e._v("产业资源")])],1)],1),e._v(" "),e.utils.IsAdmin(e.userInfo.role)?i("a-menu-item",{key:"userManage"},[i("router-link",{attrs:{to:{name:"userManage"}}},[i("a-icon",{attrs:{type:"team"}}),e._v(" "),i("span",[e._v("用户管理")])],1)],1):e._e()],1)],1),e._v(" "),i("a-col",{attrs:{span:21}},[i("div",{staticClass:"content-app"},[i("transition",{attrs:{name:"fadeInUp",mode:"out-in"}},[i("router-view")],1)],1)])],1)},staticRenderFns:[]};var d=i("VU/8")(c,l,!1,function(e){i("kPNX")},"data-v-4217b82e",null);t.default=d.exports},qKVm:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("sCp5"),r=i("FN8c"),s=i("oAV5"),n=[{title:"用户名",dataIndex:"user_name",key:"user_name"},{title:"姓名",scopedSlots:{customRender:"name"}},{title:"电话",scopedSlots:{customRender:"phone"}},{title:"单位",scopedSlots:{customRender:"company"}},{title:"角色",scopedSlots:{customRender:"role"}},{title:"创建时间",dataIndex:"createdAt",key:"createdAt"},{title:"更新时间",dataIndex:"updatedAt",key:"updatedAt"},{title:"认 证",key:"verify",scopedSlots:{customRender:"verify"}},{title:"操 作",key:"action",scopedSlots:{customRender:"action"}}],o={name:"users",components:{userVerify:i("2Bbf").a},data:function(){return{loading:!1,keywords:"",currentCertificateForm:{certificatePicList:[]},editForm:{},editTitle:"",editModalVisible:!1,columns:n,users:[],pageSize:20,pageIndex:1,count:0,certificateModalVisible:!1}},mounted:function(){this.init()},watch:{pageIndex:function(){this.init()},count:function(){(this.pageIndex-1)*this.pageSize===this.count&&(this.pageIndex-=1)},keywords:function(){this.init()}},filters:{role2CN:function(e){return e.role===r.d.ADMIN?"管理员":e.role===r.d.SUPER_ADMIN?"超级管理员":e.role===r.d.NORMAL?"普通用户":void 0},verified2CN:function(e){return e?"已认证":"未认证"}},methods:{init:function(){var e=this;this.loading=!0,a.a.getUsers(this.pageSize,this.pageIndex,this.keywords).then(function(t){e.count=t.data.data.count,e.users=t.data.data.users,e.loading=!1})},showCertificateModal:function(e){this.currentCertificateForm=e.certificate,this.certificateModalVisible=!0},performEdit:function(){var e=this;a.a.editUser(this.editForm.ID,this.editForm).then(function(t){e.$success("修改用户成功!"),e.editModalVisible=!1,e.init()})},goToEdit:function(e){this.editForm=s.a.Copy(e),this.editTitle=e.user_name,this.editModalVisible=!0},performDelete:function(e){var t=this;a.a.deleteUser(e.ID).then(function(i){t.$success("成功删除用户: "+e.user_name),t.init()})},showDeleteModal:function(e){var t=this;this.$confirm({title:"删除",content:"是否确认删除 "+e.user_name,onOk:function(){t.performDelete(e)}})}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-modal",{attrs:{visible:e.editModalVisible,title:e.editTitle,maskClosable:!1},on:{cancel:function(t){e.editModalVisible=!1},ok:e.performEdit}},[i("a-form-model",{ref:"editForm",attrs:{model:e.editForm,"label-col":{span:4},"wrapper-col":{span:20}}},[i("a-form-model-item",{ref:"user_name",attrs:{label:"用户名",prop:"user_name"}},[i("a-input",{attrs:{tabindex:"1"},on:{blur:function(){e.$refs.user_name.onFieldBlur()}},model:{value:e.editForm.user_name,callback:function(t){e.$set(e.editForm,"user_name",t)},expression:"editForm.user_name"}})],1),e._v(" "),i("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[i("a-input",{attrs:{tabindex:"2",type:"password",placeholder:"该字段不为空则修改密码"},model:{value:e.editForm.password,callback:function(t){e.$set(e.editForm,"password",t)},expression:"editForm.password"}})],1),e._v(" "),i("a-form-model-item",{attrs:{label:"角色",prop:"role"}},[i("a-select",{staticStyle:{width:"120px"},model:{value:e.editForm.role,callback:function(t){e.$set(e.editForm,"role",t)},expression:"editForm.role"}},[i("a-select-option",{attrs:{value:0}},[e._v("\n              普通用户\n            ")]),e._v(" "),i("a-select-option",{attrs:{value:1}},[e._v("\n              管理员\n            ")]),e._v(" "),i("a-select-option",{attrs:{disabled:!0,value:2}},[e._v("\n              超级管理员\n            ")])],1)],1),e._v(" "),i("a-form-model-item",{attrs:{label:"认证",prop:"certificationVerified"}},[i("a-switch",{model:{value:e.editForm.certificationVerified,callback:function(t){e.$set(e.editForm,"certificationVerified",t)},expression:"editForm.certificationVerified"}})],1)],1)],1),e._v(" "),i("div",{staticStyle:{"text-align":"right"}},[i("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索姓名、单位、电话",size:"small"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1),e._v(" "),i("a-table",{staticClass:"mt-10",attrs:{columns:e.columns,"data-source":e.users,"row-key":function(e){return e.ID},pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"role",fn:function(t,a){return i("span",{},[e._v("\n        "+e._s(e._f("role2CN")(a))+"\n      ")])}},{key:"verify",fn:function(t,a){return i("span",{on:{click:function(t){return e.showCertificateModal(a)}}},[i("a",[e._v(e._s(e._f("verified2CN")(t.certificationVerified)))])])}},{key:"phone",fn:function(t,a){return i("span",{},[i("span",[e._v(e._s(t.certificate.phone?t.certificate.phone:"/"))])])}},{key:"name",fn:function(t,a){return i("span",{},[i("span",[e._v(e._s(t.certificate.name?t.certificate.name:"/"))])])}},{key:"company",fn:function(t,a){return i("span",{},[i("span",[e._v(e._s(t.certificate.company?t.certificate.company:"/"))])])}},{key:"action",fn:function(t,a){return i("span",{},[i("a",{on:{click:function(t){return e.goToEdit(a)}}},[e._v("编辑")]),e._v(" "),i("a-divider",{attrs:{type:"vertical"}}),e._v(" "),i("a",{on:{click:function(t){return e.showDeleteModal(a)}}},[e._v("删除")])],1)}}])}),e._v(" "),i("a-row",{staticClass:"mt-20"},[i("a-pagination",{staticStyle:{display:"inline-block",float:"right"},attrs:{"page-size":e.pageSize,total:e.count},model:{value:e.pageIndex,callback:function(t){e.pageIndex=t},expression:"pageIndex"}})],1),e._v(" "),i("userVerify",{attrs:{passedInCertificateForm:e.currentCertificateForm,certificateModalVisible:e.certificateModalVisible},on:{changed:e.init,closeUserVerifyModal:function(t){e.certificateModalVisible=!1}}})],1)},staticRenderFns:[]};var l=i("VU/8")(o,c,!1,function(e){i("jqfP")},"data-v-0439263a",null);t.default=l.exports}});
//# sourceMappingURL=2.93d77586b2dd82ce01c1.js.map